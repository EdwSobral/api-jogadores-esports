# API de Jogadores de eSportes

API RESTful desenvolvida em Node.js para gerenciamento de jogadores de eSportes, com opera√ß√µes CRUD completas e busca por nome.

## üöÄ Tecnologias

- Node.js
- Express.js
- UUID (gera√ß√£o de IDs √∫nicos)
- Dotenv (vari√°veis de ambiente)

## üìã Caracter√≠sticas

- ‚úÖ Opera√ß√µes CRUD completas
- ‚úÖ Busca por nome de jogador (parcial e case-insensitive)
- ‚úÖ Arquitetura em camadas (MVC)
- ‚úÖ Programa√ß√£o ass√≠ncrona com async/await
- ‚úÖ Tratamento centralizado de exce√ß√µes em 3 n√≠veis
- ‚úÖ Valida√ß√£o de dados robusta
- ‚úÖ Mensagens de erro descritivas
- ‚úÖ Banco de dados em mem√≥ria (simula√ß√£o com Map)

## üìÅ Estrutura do Projeto

```
api-jogadores-esports/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.js          # Simula√ß√£o de banco de dados
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jogadorModel.js      # L√≥gica de neg√≥cio e valida√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jogadorController.js # Controladores das rotas
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jogadorRoutes.js     # Defini√ß√£o das rotas
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.js      # Tratamento de erros
‚îÇ   ‚îî‚îÄ‚îÄ app.js                   # Configura√ß√£o do Express
‚îú‚îÄ‚îÄ server.js                    # Inicializa√ß√£o do servidor
‚îú‚îÄ‚îÄ testes.http                  # Testes completos (REST Client)
‚îú‚îÄ‚îÄ demo.http                    # Testes para demonstra√ß√£o
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ .env
‚îî‚îÄ‚îÄ README.md
```

## üîß Instala√ß√£o

### Pr√©-requisitos
- Node.js (v16 ou superior)
- VS Code (recomendado)
- REST Client (extens√£o do VS Code)

### Passos:

1. Clone o reposit√≥rio ou extraia os arquivos

2. Instale as depend√™ncias:
```bash
npm install
```

3. Configure as vari√°veis de ambiente (arquivo `.env` j√° est√° configurado)

4. Inicie o servidor:
```bash
# Modo desenvolvimento (com nodemon)
npm run dev

# Modo produ√ß√£o
npm start
```

5. O servidor estar√° rodando em `http://localhost:3000`

## üì° Endpoints da API

### Estrutura de Dados do Jogador
```json
{
  "codigo_jogador": "uuid-gerado-automaticamente",
  "nome_jogador": "Nome do Jogador",
  "habilidade_principal": "Habilidade",
  "criado_em": "2025-10-30T...",
  "atualizado_em": "2025-10-30T..." // (apenas em updates)
}
```

### 1. **Criar Jogador**
- **M√©todo:** POST
- **Rota:** `/api/jogadores`
- **Body:**
```json
{
  "nome_jogador": "Faker",
  "habilidade_principal": "Mid Lane"
}
```
- **Valida√ß√µes:**
  - nome_jogador: obrigat√≥rio, m√≠nimo 3 caracteres, m√°ximo 100 caracteres
  - habilidade_principal: obrigat√≥rio, n√£o vazio
- **Resposta (201):**
```json
{
  "sucesso": true,
  "mensagem": "Jogador criado com sucesso",
  "dados": {
    "codigo_jogador": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "nome_jogador": "Faker",
    "habilidade_principal": "Mid Lane",
    "criado_em": "2025-10-30T15:30:00.000Z"
  }
}
```

### 2. **Listar Todos os Jogadores**
- **M√©todo:** GET
- **Rota:** `/api/jogadores`
- **Resposta (200):**
```json
{
  "sucesso": true,
  "quantidade": 4,
  "dados": [...]
}
```

### 3. **Buscar Jogador por C√≥digo**
- **M√©todo:** GET
- **Rota:** `/api/jogadores/:codigo`
- **Exemplo:** `/api/jogadores/a1b2c3d4-e5f6-7890-abcd-ef1234567890`
- **Resposta (200):**
```json
{
  "sucesso": true,
  "dados": {
    "codigo_jogador": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "nome_jogador": "Faker",
    "habilidade_principal": "Mid Lane",
    "criado_em": "2025-10-30T15:30:00.000Z"
  }
}
```

### 4. **Buscar Jogadores por Nome** (Funcionalidade Especial)
- **M√©todo:** GET
- **Rota:** `/api/jogadores/buscar?nome={nome}`
- **Caracter√≠sticas:**
  - Busca parcial (n√£o precisa ser nome completo)
  - Case-insensitive (mai√∫sculas/min√∫sculas n√£o importam)
  - Busca no campo nome_jogador e habilidade_principal
- **Exemplos:** 
  - `/api/jogadores/buscar?nome=Faker` ‚Üí Busca exata
  - `/api/jogadores/buscar?nome=Mid` ‚Üí Encontra todos com "Mid Lane"
  - `/api/jogadores/buscar?nome=uzi` ‚Üí Encontra "Uzi" (case-insensitive)
- **Resposta (200):**
```json
{
  "sucesso": true,
  "quantidade": 2,
  "dados": [...]
}
```

### 5. **Atualizar Jogador**
- **M√©todo:** PUT
- **Rota:** `/api/jogadores/:codigo`
- **Body:**
```json
{
  "nome_jogador": "Faker Pro",
  "habilidade_principal": "Mid Lane Expert"
}
```
- **Resposta (200):**
```json
{
  "sucesso": true,
  "mensagem": "Jogador atualizado com sucesso",
  "dados": {
    "codigo_jogador": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "nome_jogador": "Faker Pro",
    "habilidade_principal": "Mid Lane Expert",
    "atualizado_em": "2025-10-30T16:00:00.000Z"
  }
}
```

### 6. **Remover Jogador**
- **M√©todo:** DELETE
- **Rota:** `/api/jogadores/:codigo`
- **Resposta (200):**
```json
{
  "sucesso": true,
  "mensagem": "Jogador removido com sucesso"
}
```

## üß™ Testando a API

### Op√ß√£o 1: REST Client (Recomendado)

A forma mais pr√°tica de testar √© usando a extens√£o **REST Client** do VS Code.

#### Instala√ß√£o:
1. Abra o VS Code
2. V√° em Extensions (Ctrl + Shift + X)
3. Busque por "REST Client"
4. Instale a extens√£o de Huachao Mao

#### Arquivos de Teste:

O projeto inclui dois arquivos `.http` para facilitar os testes:

**`testes.http` - Testes Completos (17 requests)**
- Todos os cen√°rios de CRUD
- Testes de valida√ß√£o
- Testes de erro (400, 404)
- Use este arquivo para testar tudo antes da apresenta√ß√£o

**`demo.http` - Demonstra√ß√£o (9 requests)**
- Requests principais e mais importantes
- Fluxo simplificado para apresenta√ß√µes
- Coment√°rios explicativos
- Use este arquivo durante a apresenta√ß√£o

#### Como usar:

1. Certifique-se que o servidor est√° rodando (`npm start`)
2. Abra o arquivo `testes.http` ou `demo.http`
3. Clique em **"Send Request"** que aparece acima de cada request
4. A resposta aparecer√° em uma nova aba ao lado

#### Exemplo pr√°tico:

```http
### Criar Jogador
POST http://localhost:3000/api/jogadores
Content-Type: application/json

{
  "nome_jogador": "Faker",
  "habilidade_principal": "Mid Lane"
}
```

Clique em "Send Request" acima do POST e veja a resposta!

### Op√ß√£o 2: cURL (Terminal)

**Criar jogador:**
```bash
curl -X POST http://localhost:3000/api/jogadores \
  -H "Content-Type: application/json" \
  -d '{"nome_jogador":"Faker","habilidade_principal":"Mid Lane"}'
```

**Listar todos:**
```bash
curl http://localhost:3000/api/jogadores
```

**Buscar por nome:**
```bash
curl "http://localhost:3000/api/jogadores/buscar?nome=Faker"
```

**Atualizar:**
```bash
curl -X PUT http://localhost:3000/api/jogadores/{codigo_jogador} \
  -H "Content-Type: application/json" \
  -d '{"nome_jogador":"Faker Pro","habilidade_principal":"Mid Expert"}'
```

**Remover:**
```bash
curl -X DELETE http://localhost:3000/api/jogadores/{codigo_jogador}
```

### Op√ß√£o 3: Postman ou Insomnia

1. Importe a cole√ß√£o ou crie manualmente as requisi√ß√µes
2. Configure a URL base: `http://localhost:3000`
3. Teste cada endpoint conforme documentado

### Op√ß√£o 4: Navegador (apenas GET)

Abra o navegador e acesse:
- `http://localhost:3000` ‚Üí Documenta√ß√£o
- `http://localhost:3000/api/jogadores` ‚Üí Listar todos
- `http://localhost:3000/api/jogadores/buscar?nome=Faker` ‚Üí Buscar

## üõ°Ô∏è Tratamento de Erros

A API possui tratamento centralizado de erros com mensagens descritivas:

### Status Codes:
- **200 OK**: Opera√ß√£o bem-sucedida (GET, PUT, DELETE)
- **201 Created**: Recurso criado com sucesso (POST)
- **400 Bad Request**: Dados inv√°lidos ou requisi√ß√£o malformada
- **404 Not Found**: Recurso n√£o encontrado
- **500 Internal Server Error**: Erro interno do servidor

### Exemplos de Erros:

**Valida√ß√£o (400):**
```json
{
  "sucesso": false,
  "tipo": "Erro de Valida√ß√£o",
  "mensagem": "Dados inv√°lidos: O nome deve ter pelo menos 3 caracteres"
}
```

**N√£o Encontrado (404):**
```json
{
  "sucesso": false,
  "tipo": "N√£o Encontrado",
  "mensagem": "Nenhum jogador encontrado com esse c√≥digo"
}
```

**Rota Inexistente (404):**
```json
{
  "sucesso": false,
  "tipo": "Rota N√£o Encontrada",
  "mensagem": "A rota GET /api/jogador n√£o existe nesta API",
  "dica": "Verifique a documenta√ß√£o para ver as rotas dispon√≠veis"
}
```

## üéØ Conceitos T√©cnicos Aplicados

### 1. Arquitetura em Camadas (MVC adaptado)
- **Model**: L√≥gica de neg√≥cio e valida√ß√µes
- **Controller**: Controle de fluxo e respostas HTTP
- **Routes**: Defini√ß√£o de endpoints
- **Middleware**: Tratamento centralizado de erros

### 2. Programa√ß√£o Ass√≠ncrona
- Uso de `async/await` em todas as opera√ß√µes
- Promises para simular opera√ß√µes de I/O
- Event loop n√£o-bloqueante do Node.js

### 3. Tratamento de Exce√ß√µes (3 n√≠veis)
- **Model**: Valida dados e lan√ßa erros espec√≠ficos
- **Controller**: Captura com try-catch e passa para middleware
- **Middleware**: Analisa erro e retorna status HTTP apropriado

### 4. Estrutura de Dados
- Map para armazenamento O(1) em buscas por chave
- UUID v4 para gera√ß√£o de identificadores √∫nicos
- Timestamps ISO 8601 para rastreabilidade

### 5. Valida√ß√µes
- Valida√ß√£o de tipos (typeof)
- Valida√ß√£o de tamanho (length)
- Valida√ß√£o de obrigatoriedade
- Sanitiza√ß√£o de dados (trim)

### 6. Boas Pr√°ticas
- Separa√ß√£o de responsabilidades
- C√≥digo autodocumentado
- Mensagens de erro descritivas
- Logs informativos
- Middleware de tratamento de erros
- Graceful shutdown

## üéì Arquitetura Explicada

### Fluxo de uma Requisi√ß√£o:

```
Cliente HTTP
    ‚Üì
Express (app.js)
    ‚Üì
Middleware: express.json() ‚Üí Converte body em JSON
    ‚Üì
Middleware: Logger ‚Üí Registra no console
    ‚Üì
Routes (jogadorRoutes.js) ‚Üí Identifica rota
    ‚Üì
Controller (jogadorController.js) ‚Üí Extrai dados da requisi√ß√£o
    ‚Üì
Model (jogadorModel.js) ‚Üí Valida e aplica regras de neg√≥cio
    ‚Üì
Database (database.js) ‚Üí Persiste/busca dados
    ‚Üì
Model ‚Üí Retorna dados processados
    ‚Üì
Controller ‚Üí Formata resposta HTTP
    ‚Üì
Middleware: errorHandler (se houver erro) ‚Üí Trata e formata erro
    ‚Üì
Cliente HTTP ‚Üê Recebe resposta JSON
```

### Por que separar em camadas?

1. **Manutenibilidade**: Sei exatamente onde est√° cada funcionalidade
2. **Testabilidade**: Posso testar cada camada isoladamente
3. **Reusabilidade**: Model pode ser usado em GraphQL, CLI, Workers
4. **Escalabilidade**: F√°cil adicionar cache, queue, logging
5. **Colabora√ß√£o**: M√∫ltiplos desenvolvedores sem conflitos

## üí° Diferencial: Map vs Array

Escolhi **Map** ao inv√©s de **Array** porque:

| Opera√ß√£o | Array | Map |
|----------|-------|-----|
| Buscar por ID | O(n) - linear | O(1) - constante |
| Inserir | O(1) | O(1) |
| Deletar | O(n) | O(1) |
| Verificar exist√™ncia | O(n) | O(1) |

Com 1000 jogadores:
- Array: precisa percorrer at√© 1000 elementos
- Map: acesso direto (hash table)

## üìù Observa√ß√µes Importantes

### Limita√ß√µes do Banco em Mem√≥ria:
- ‚ö†Ô∏è Dados s√£o perdidos ao reiniciar o servidor
- ‚ö†Ô∏è N√£o h√° persist√™ncia entre sess√µes
- ‚ö†Ô∏è Limitado pela mem√≥ria RAM dispon√≠vel
- ‚ö†Ô∏è Sem suporte a transa√ß√µes

### Migra√ß√£o para Banco Real:

Para produ√ß√£o, basta substituir `database.js` por um ORM:

**PostgreSQL com Sequelize:**
```javascript
const jogador = await Jogador.findByPk(codigo);
```

**MongoDB com Mongoose:**
```javascript
const jogador = await Jogador.findById(codigo);
```

Os **Models e Controllers n√£o precisam mudar** - essa √© a vantagem da arquitetura em camadas!

## üöÄ Melhorias Futuras

Para um ambiente de produ√ß√£o, consideraria:

1. **Banco de Dados Real**: PostgreSQL, MongoDB ou MySQL
2. **Autentica√ß√£o**: JWT para proteger endpoints
3. **Autoriza√ß√£o**: Controle de permiss√µes por usu√°rio
4. **Pagina√ß√£o**: Limitar resultados em listagens
5. **Rate Limiting**: Prevenir abuso da API
6. **CORS**: Permitir consumo por frontends
7. **Logging Avan√ßado**: Winston ou Pino
8. **Testes Automatizados**: Jest ou Mocha
9. **Documenta√ß√£o Interativa**: Swagger/OpenAPI
10. **Cache**: Redis para consultas frequentes
11. **CI/CD**: GitHub Actions ou GitLab CI
12. **Containeriza√ß√£o**: Docker e Docker Compose
13. **Monitoramento**: Prometheus e Grafana
14. **Valida√ß√£o de Schema**: Joi ou Yup

## üë®‚Äçüíª Eduardo SObral

Desenvolvido para a disciplina de Programa√ß√£o Server-Side - N2
Engenharia de Software - 3¬∫ Semestre
Cat√≥lica SC

## üìÑ Licen√ßa

Este projeto √© livre para uso educacional.